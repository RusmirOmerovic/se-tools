#!/bin/bash
# merge-test.sh
# Merge develop -> testing mit Sicherheits-Checks

set -e

# 1. Aktuelle Branches holen
git fetch origin --prune

# 2. PrÃ¼fen, ob wir auf develop sind
if [[ $(git branch --show-current) != "develop" ]]; then
  echo "â— Du musst auf 'develop' sein! Nutze: git checkout develop"
  exit 1
fi

# 3. PrÃ¼fen, ob ungespeicherte Ã„nderungen da sind
if ! git diff --quiet || ! git diff --cached --quiet; then
  echo "â— Es gibt uncommitted Changes â€“ bitte committen oder stashen."
  exit 1
fi

# 4. Sicher pushen
pushrepo   # Falls du lieber den Standard 'pushrepo' Flow nutzen willst

# 5. Branch wechseln & mergen
git checkout testing
git merge develop --no-ff -m "ğŸ”€ Merge develop into testing"

# 6. Pushen & zurÃ¼ck zu develop
git push origin testing
git checkout develop

echo "âœ… Merge develop â†’ testing abgeschlossen."
